<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Teacher Portal</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
  <script defer src="\static\teacher.js"></script>
  <script defer src="\static\index.js"></script>
  <link rel="stylesheet" href="\static\login-page.css">
  <link rel="icon" href="\static\filename.jpg" type="image/gif" sizes="16x16">
</head>
<style>
  /* Style the tab */
  .tab {
    overflow: hidden;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
  }

  /* Style the buttons inside the tab */
  .tab button {
    background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
    font-size: 17px;
  }

  /* Change background color of buttons on hover */
  .tab button:hover {
    background-color: #ddd;
  }

  /* Create an active/current tablink class */
  .tab button.active {
    background-color: #ccc;
  }

  /* Style the tab content */
  .tabcontent {

    padding: 6px 12px;
    border: 1px solid #ccc;
    border-top: none;
  }
</style>
<script>
  function ArrayToObject(arr) {
    var obj = {};
    for (var i = 1; i <= arr.length; i++) {
      obj[i] = arr[i - 1];
    }
    return obj
  }
  var data = JSON.parse(localStorage.getItem("subjects"));
  var regId = localStorage.getItem("regId");
  var sch_name = localStorage.getItem("schoolname");
  var student_data;
  console.log(data)

  function getData() {
    var col = new FormData();
    col.append("regId", regId);
    col.append("class", "9");
    col.append("schoolname", sch_name);
    fetch('/assignment/submission/getAll', {
      method: 'POST',
      body: col
    }).then(function (response) {
      //console.log(response);
      return response.json();

    }).then(function (data1) {

      if (data1.response == "assignment not found") {
        var tabsContainer = document.getElementById("report_TextBoxesGroup");

        tabsContainer.innerHTML += '<div style="text-align: center; padding: 20px;"><h5>No assignment documents found</h5></div>';

      }
      else {
        student_data = ArrayToObject(data1);
        console.log(student_data);
        buildDocument();
      }
    });
  }

  function buildDocument() {
    var cnt = 1;
    var tabsContainer = document.getElementById("tabs");

    tabsContainer.innerHTML = "";

    var uList = document.createElement("div");



    for (key in data) {

      if (key == "9") {
        for (index in data[key]) {

          for (value in data[key][index]) {
            var li1 = document.createElement("div");
            //var li2 = document.createElement("li");
            li1.id = "sub" + cnt;

            li1.innerHTML = '<button id="button' + cnt + '" class="tablinks" onclick=getstudent(event,"' + data[key][index][value] + '","' + index + '") >' + data[key][index][value] + ' - ' + index + '</button>';

            //li2.innerHTML = '<a href="#tabs-2">One</a>';

            uList.appendChild(li1);

            cnt++;
          }
        }
      }
    }



    tabsContainer.appendChild(uList);
    //tabsContainer.appendChild(t1);

    $("#tabs").tabs();
    var first = document.getElementById("button1");

    first.click();

  }
  window.onload = function () {
    getData();

  }

  function getstudent(evt, id, section) {
    var tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    var tabsContainer2 = document.getElementById("tabs");
    var tabs = document.getElementById("students");
    tabs.innerHTML = "";
    var table1 = document.createElement("table");
    var t1 = "";
    table1.id = "tabs" + id;
    table1.className = "table";
    t1 += `<thead class="thead-light">
              <tr>
              <th>Register.No</th>
              <th>Class</th>
              <th>Section</th>
              <th>Submitted Date</th>
              <th>Submitted Time</th>
              <th>Assignments</th>
              
              </tr>
          </thead>`;



    for (data in student_data) {

      if (student_data[data]["subject"] == id && student_data[data]["section"] == section) {


        //t1.className = "tabcontent";
        object = student_data[data];

        t1 += "<tbody>";
        t1 += "<tr>";
        t1 += "<td>" + student_data[data]["regno"] + "</td>";
        t1 += "<td>" + student_data[data]["class"] + "</td>";
        t1 += "<td>" + student_data[data]["section"] + "</td>";
        t1 += "<td>" + student_data[data]["submitted_date"] + " </td>";
        t1 += "<td>" + student_data[data]["submitted_time"] + "</td>";
        t1 += '<td><a class="btn btn-primary" onclick="getassignmnet(object)">View Assignment</a></td>';
        t1 += "</tr>";
        t1 += "</tbody>";
        table1.innerHTML = t1;

        tabs.appendChild(table1);

      }
    }
    evt.currentTarget.className += " active";
  }



  function getassignmnet(dataObject) {
    console.log(dataObject);
    localStorage.setItem("sendprint", JSON.stringify(dataObject));
    printing();
  }
  function printing() {
    location.href = "/assignment-view";
  }
</script>

<body>
  <div id="teacher-div"></div>
  <div class="container-fluid">
    <div class="p-3 m-3">
      <div class="p-3 m-3">
        <div class="container">
          <!-- Container-->
          <div id="report_TextBoxesGroup" class="container bg-light p-3">
            <h5 style="font-size: 25px; font-weight: bold" class="text-center pb-3 display-5" id="heading"> Student
              Assignment Details - 9th Standard </h5>

            <!-- <div id="tabs" class="tab">
            
              </div>
              <div id="students">
      
              </div> -->
            <br>
            <div class="container">
              <div id="tabs" class="tab">

              </div>
              <div id="students">

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>


  <!-- <input type="button" id="cash_narrat" style="width: 90px;" value="click" class="form-control btn btn-primary" name="cash_narrat" data-toggle="modal" data-target="#narratModal" /> -->

  <div class="modal fade" id="narratModal" tabindex="-1" role="dialog" aria-labelledby="narratModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title modal_head" id="narratModalLabel">Narration</h4>
          <button type="button" class="close cash-dismiss" data-dismiss="modal" aria-label="Close"><span
              aria-hidden="true">&times;</span></button>
        </div>
        <div class="modal-body">
          <label class="modal_note">Section</label>
          <input id="section" class="myInput form-control form-control-sm" />
        </div>

        <div class="modal-body">
          <label class="modal_note">Examination</label>
          <select id="exam-name" class="myInput form-control form-control-sm">
            <option value="Mid-term test1">Mid-term test 1</option>
            <option value="Mid-term test2">Mid-term test 2</option>
            <option value="Mid-term test3">Mid-term test 3</option>
            <option value="Quarterly Examination">Quarterly Examination</option>
            <option value="Half-yearly Examination">Half-yearly Examination</option>
            <option value="Annual Examination">Annual Examination</option>
          </select>
        </div>


        <div class="modal-footer narr_footer">
          <button type="button" class="btn btn-primary cashmodal_btn" id="narrat_ok" onclick="mySelect()"
            data-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>
</body>

</html>